# 秀丸エディタ用 CP932互換文字チェッカー＆ノーマライザー

## 概要

このプロジェクトは、秀丸エディタ上でテキストをShift_JIS (正確には Microsoft Code Page 932) と互換性のある形式に正規化（ノーマライズ）するためのマクロです。

ファイルの文字コードをShift_JISで保存する必要がある場面で、意図せずCP932に変換できない文字（例: `①`、`—` (em dash)、一部の絵文字など）が使用されていることがあります。このマクロを実行すると、それらの文字を自動的に互換性のある標準的な文字（例: `1`、`―` (Japanese dash)）に変換します。

変換処理には、高速化のためにC++で記述されたネイティブDLLを利用しています。

## 主な機能

- **CP932変換可否チェック**: C++で実装されたDLLにより、文字列がCP932に変換可能かを高速に判定します。
- **文字の正規化**: 変換できない文字を、Unicode正規化（NFCおよびNFKC）を利用して互換性のある文字に変換します。
- **柔軟な適用範囲**: 秀丸エディタで選択している範囲、またはファイル全体に対してマクロを適用できます。

## ファイル構成

リポジトリには以下のファイルが含まれています。

- `HmNormToStandardCharByJS.mac`
  - 秀丸エディタで実行するマクロ本体です。
- `CanConvertCP932_x64.dll`
  - 64bit版の秀丸エディタ用の、CP932変換チェックを行うためのDLLです。
- `CanConvertCP932_x86.dll`
  - 32bit版の秀丸エディタ用の、CP932変換チェックを行うためのDLLです。
- `CanConvertCP932/`
  - DLLのソースコード一式が格納されています。

## 使い方

1. 以下の3つのファイルをダウンロードし、同じフォルダに配置します。
   - `HmNormToStandardCharByJS.mac`
   - `CanConvertCP932_x64.dll`
   - `CanConvertCP932_x86.dll`
2. 秀丸エディタのマクロメニューから `HmNormToStandardCharByJS.mac` を実行します。
3. 選択範囲がある場合はその範囲のテキストが、ない場合はファイル全体のテキストが正規化されます。

## 開発者向け情報 (DLLのビルド方法)

`CanConvertCP932.dll` を自身でビルドする場合は、以下の手順に従ってください。

1. `CanConvertCP932/CanConvertCP932.sln` をVisual Studioで開きます。
2. ビルド構成を `Release` に設定します。
3. `x86` と `x64` の両方のプラットフォームでビルドを実行します。
4. `Release/` フォルダ（32bit版）と `x64/Release/` フォルダ（64bit版）に、それぞれDLLが出力されます。

## ライセンス

このプロジェクトは [MIT License](LICENSE) のもとで公開されています。
